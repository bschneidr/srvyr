<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Summarise multiple values into cascading groups — cascade • srvyr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Summarise multiple values into cascading groups — cascade"><meta property="og:description" content="cascade is similar to summarise, but calculates
a summary statistics for the total of a group in addition to each group.
The groupings are chosen by &quot;unpeeling&quot; from the end of the groupings,
and also expanding out interactions to all terms (eg the interactions of
all combinations of subsets of variables as well as each variable on
it's own)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
<img src="../tools/logo.png" height="50" width="50" align="left" display="block" style="margin: -15px 10px 0px 0px">
        <a class="navbar-link" href="../index.html">srvyr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/srvyr-vs-survey.html">Overview</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/srvyr-vs-survey.html">srvyr Compared to the survey Package (Overview)</a>
    </li>
    <li>
      <a href="../articles/srvyr-database.html">Databases in srvyr</a>
    </li>
    <li>
      <a href="../articles/extending-srvyr.html">Extending srvyr</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/gergness/srvyr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summarise multiple values into cascading groups</h1>
    <small class="dont-index">Source: <a href="https://github.com/gergness/srvyr/blob/HEAD/R/cascade.r" class="external-link"><code>R/cascade.r</code></a></small>
    <div class="hidden name"><code>cascade.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>cascade</code> is similar to <code><a href="summarise.html">summarise</a></code>, but calculates
a summary statistics for the total of a group in addition to each group.
The groupings are chosen by "unpeeling" from the end of the groupings,
and also expanding out interactions to all terms (eg the interactions of
all combinations of subsets of variables as well as each variable on
it's own).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cascade</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span>, .fill <span class="op">=</span> <span class="cn">NA</span>, .fill_level_top <span class="op">=</span> <span class="cn">FALSE</span>, .groupings <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.data, </dt>
<dd><p>tbl A <code>tbl_svy</code> object</p></dd>


<dt>...</dt>
<dd><p>Name-value pairs of summary functions</p></dd>


<dt>.fill</dt>
<dd><p>Value to fill in for group summaries</p></dd>


<dt>.fill_level_top</dt>
<dd><p>When filling factor variables, whether to put the
value `.fill` in the first position (defaults to FALSE, placing it in
the bottom).</p></dd>


<dt>.groupings</dt>
<dd><p>(Experimental) A list of lists of quosures to manually
specify the groupings to use, rather than the default.</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/" class="external-link">survey</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">api</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dstrata</span> <span class="op">&lt;-</span> <span class="va">apistrat</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_survey_design.html">as_survey_design</a></span><span class="op">(</span>strata <span class="op">=</span> <span class="va">stype</span>, weights <span class="op">=</span> <span class="va">pw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculates the means by stype and also for the whole</span></span></span>
<span class="r-in"><span><span class="co"># sample</span></span></span>
<span class="r-in"><span><span class="va">dstrata</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="group_by.html">group_by</a></span><span class="op">(</span><span class="va">stype</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">cascade</span><span class="op">(</span>api99_mn <span class="op">=</span> <span class="fu"><a href="survey_mean.html">survey_mean</a></span><span class="op">(</span><span class="va">api99</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            api00_mn <span class="op">=</span> <span class="fu"><a href="survey_mean.html">survey_mean</a></span><span class="op">(</span><span class="va">api00</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            api_diff <span class="op">=</span> <span class="fu"><a href="survey_mean.html">survey_mean</a></span><span class="op">(</span><span class="va">api00</span> <span class="op">-</span> <span class="va">api99</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   stype api99_mn api99_mn_se api00_mn api00_mn_se api_diff api_diff_se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> E         636.        13.3     674.       12.5     38.6         2.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> H         617.        15.8     626.       15.5      8.46        3.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> M         610.        16.8     637.       16.6     26.4         3.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>        629.        10.1     662.        9.54    32.9         2.08</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculates the proportions by the interaction of stype &amp; awards</span></span></span>
<span class="r-in"><span><span class="co"># as well as by each of those variable's groups alone, and finally</span></span></span>
<span class="r-in"><span><span class="co"># the total as well</span></span></span>
<span class="r-in"><span><span class="va">dstrata</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="group_by.html">group_by</a></span><span class="op">(</span><span class="fu"><a href="interact.html">interact</a></span><span class="op">(</span><span class="va">stype</span>, <span class="va">awards</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">cascade</span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="survey_mean.html">survey_mean</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    stype awards   prop  prop_se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> E     No     0.193  3.18<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> E     Yes    0.521  3.18<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> E     <span style="color: #BB0000;">NA</span>     0.714  1.28<span style="color: #949494;">e</span><span style="color: #BB0000;">-17</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> H     No     0.082<span style="text-decoration: underline;">9</span> 8.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> H     Yes    0.039<span style="text-decoration: underline;">0</span> 8.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> H     <span style="color: #BB0000;">NA</span>     0.122  1.35<span style="color: #949494;">e</span><span style="color: #BB0000;">-17</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> M     No     0.085<span style="text-decoration: underline;">5</span> 1.17<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> M     Yes    0.078<span style="text-decoration: underline;">9</span> 1.17<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> M     <span style="color: #BB0000;">NA</span>     0.164  2.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-17</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> <span style="color: #BB0000;">NA</span>    No     0.361  3.49<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> <span style="color: #BB0000;">NA</span>    Yes    0.639  3.49<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     1.00   5.15<span style="color: #949494;">e</span><span style="color: #BB0000;">-32</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Can also specify the .groupings manually, though this interface</span></span></span>
<span class="r-in"><span><span class="co"># is a little ugly, as it requires passing a list of quosures or</span></span></span>
<span class="r-in"><span><span class="co"># symbols you've created, rather than the usual syntax</span></span></span>
<span class="r-in"><span><span class="va">dstrata</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">cascade</span><span class="op">(</span></span></span>
<span class="r-in"><span>    prop <span class="op">=</span> <span class="fu"><a href="survey_mean.html">survey_mean</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    .groupings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">quos</a></span><span class="op">(</span><span class="va">stype</span>, <span class="va">awards</span><span class="op">)</span>, <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">quos</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   stype [4]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   stype awards  prop  prop_se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> E     No     0.27  4.46<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> E     Yes    0.730 4.46<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> H     No     0.68  6.66<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> H     Yes    0.32  6.66<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> M     No     0.52  7.14<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> M     Yes    0.48  7.14<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     1.00  5.15<span style="color: #949494;">e</span><span style="color: #BB0000;">-32</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Greg Freedman Ellis, Ben Schneider.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

